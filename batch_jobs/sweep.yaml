program: train.py
method: grid
metric:
  name: val/loss
  goal: minimize
parameters:
  task:
    values:
      # - non_qa_to_qa
      # - hr_to_lr_noinst
      # - hr_to_lr
      # - hr_to_lr_dev
      # - non_nli_to_nli
      # - non_paraphrase_to_paraphrase
      # - non_class_to_class
      # - qa_to_qa
      # - class_to_class
      # - wdc-v3-cluster200
      # - cluster50_top10clusters_max20percluster
      # - wdc4-clusters50
      # - wdc4-clusters200
      - wdc4-clusters500
      # - wdc4-clusters2000
  wandb_tags:
    values: ['best-in-sweep,wdc-v4-indiv-clusters500']
  max_examples_per_task:
    values: [200]
  gradient_accumulation_steps:
    values: [1]
  lr:
    values: [5e-6]
  shuffle:
    values: [1]
  shuffle_examples_seed:
    values: [0]
  label_smoothing:
    values: [0.0]
  debug_data_order:
    values: [0]
  num_training_steps:
    values: [20000]
  repeat_batch:
    values: [1]
  verbose_train:
    values: [0]
  log_period:
    values: [2500]
  test_tasks:
    values: ['all_tasks_test']
  is_cluster_dataset:
    values: [1]
  cluster_idxs:
    values: [100,101,104,106,107,108,10,110,111,112,113,114,116,118,121,122,124,125,126,127,128,129,131,133,134,135,137,139,13,140,141,142,143,144,145,146,147,148,150,151,155,156,157,15,160,161,162,163,164,165,167,169,16,171,172,173,175,177,178,17,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,19,1,200,203,204,205,206,209,20,211,212,214,215,216,217,218,21,225,227,228,229,22,230,233,235,236,237,238,239,23,240,241,243,247,248,249,24,251,252,255,256,257,258,260,261,263,266,268,269,26,270,272,273,276,277,27,280,281,282,283,285,286,287,289,291,292,293,295,29,2,300,301,302,304,305,306,307,309,30,310,311,312,313,314,315,316,318,31,320,322,324,325,326,327,330,332,333,336,337,338,33,342,343,345,347,349,34,350,352,353,355,356,357,359,35,363,365,368,369,36,373,374,375,376,377,378,382,383,386,38,392,395,396,398,39,3,403,405,408,40,410,411,412,413,414,416,418,419,41,420,423,424,425,427,428,429,42,430,433,434,437,438,439,43,442,447,448,44,451,452,453,454,458,462,464,469,46,470,471,472,474,477,478,47,481,483,485,487,488,489,48,491,493,494,496,497,499,4,52,53,55,57,58,59,60,61,63,64,65,66,6,70,71,72,73,75,76,77,78,79,7,81,82,83,85,86,87,89,8,90,91,92,93,95,96,97,98,99,9]
  max_tasks_per_cluster:
    values: [200]
  # gpt2:
  #   values: ["gpt2-xl", "gpt2-large"]
  # init_checkpoint:
  #   values: ['checkpoints/metaicl/wdc-v2_cluster_t200/metaicl_m200-best_task_dev_score.pt']
command:
  - python
  - ${program}
  - ${args}